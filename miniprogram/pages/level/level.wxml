<!--pages/level/level.wxml-->

<view class="container">
	<view class="curBook-wrap">
		<view class="title"><image class="icon-level" src="/assets/imgs/level.png"></image>当前选择</view>
		<view class="curBookLocation">{{ curLevel.title }} · {{ curSubLevel.title }}</view>
	</view>

	<view class="levels">
		<view class="title">
			<image class="icon-level" src="/assets/imgs/levels.png"></image>级别单元列表
		</view>
		<view wx:for="{{ levelList }}" wx:key="index" wx:for-item="item">
			<!-- 推广按钮 -->
			<view wx:if="{{ !user.isPro && systemInfo_platform === 'android' && index === 1 }}" class="buy-info" bindtap="buyBtn">
				<view class="buy-wrap" >
					<view class="buy-body"><text class="old-price">￥10 </text><text class="price">￥{{ price }}</text> 元解锁全部 <text class="look-btn">查看详情</text></view>
					<!-- <view class="buy-btn">立即查看</view> -->
				</view>
			</view>
			<view style="padding: 28rpx 32rpx;">
				<cell>
					<view slot="hd" class="level-title">{{ item.title }}</view>
					<view slot="bd" style="width: 300rpx; margin-left: 42rpx;">
						<view style="color: #848A8E; font-size: 24rpx; line-height: 2.3;">进度</view>
						<van-progress color="#02AF42" show-pivot="{{false}}" percentage="{{ item.score / item.unitList.length }}" />
					</view>
				</cell>
			</view>
			<view class="unit-border"></view>
			<block wx:for="{{ item.unitList}}" wx:key="index" wx:for-item="unit">
				<view class="unit-wrap" style="background: {{ curSubLevel.levelId === unit.levelId ? 'rgb(223, 241, 213)' : 'transparent'}}">
					<view class="unit" >
						<view style="width: 40rpx;">
							<view wx:if="{{ !unit.widthIcon }}" class="dot"></view>
							<view wx:else style="margin-left: -20rpx;" data-unit="{{ unit }}" bindtap="noteBtn">
								<van-icon name="records" color="#87BE5D" size="28" />
							</view>
						</view>
						<view style="flex: 1;">
							<view class="unit-title">{{ unit.title }} </view>
							<view class="unit-status">{{ unit.isComplete ? '已完成' : (unit.score > 0 ? '未学完...' : '未学习')}}</view>
						</view>
						<view style="flex: 1">
							<image wx:if="{{ unit.isPro && !user.isPro}}" class="lock" src="/assets/imgs/article_lock.png"></image>
						</view>
						<view class="unit-select-btn" data-level="{{ unit }}" size="small" color="#3D96D3" bindtap="selectBtn">{{ unit.isComplete ? '复习' : '学习' }}</view>
					</view>
				</view>
			</block>
		</view>
	</view>

	<van-dialog id="van-dialog" />

	<van-popup show="{{ isShowNote }}" position="bottom" bind:close="popOnClose">
		<view class="note-pop">
			<!-- 年份 -->
			<block wx:if="{{ noteType === 'year'}}">
				<view class="title">年份的有两种读法(以2019为例):</view>
				<view class="content">
					<view>1. <text class="strong">两位一读</text>: 读成 twenty eighteen</view>
					<view>2. <text class="strong">按数字读</text>: 读成 two thousand and nighteen (and 可省略，即two thousand nighteen)</view>
 					<view style="margin-top: 10rpx;">注: 按数字读与「数字4位」小节重复，故此节按第一种读法发音</view>
				</view>
			</block>
			<!-- 月份 -->
			<block wx:if="{{ noteType === 'month' }}">
				<view class="title">月份单词列表:</view>
				
				<view class="content" >
					<view  wx:for="{{monthWords}}" wx:key="index" wx:for-item="item">
						<cell custom-class="month-item" data-audio="{{ item.audio }}" bindtap="wordPlay">
							<text slot="hd" class="strong">{{ item.word }}</text>
							<text slot="bd" class="phonetic">　/{{ item.phonetic}}/ {{ item.mean}}</text>
							<view slot="ft" style="display: flex; align-items: center;">
								<van-icon  name="volume-o" color="#87BE5D" size="18"  />
							</view>
						</cell>

					</view>
				</view>
			</block>
			<!-- 星期 -->
			<block wx:if="{{ noteType === 'week' }}">
				<view class="title">星期单词列表:</view>
				<view class="content" >
					<view  wx:for="{{weekWords}}" wx:key="index" wx:for-item="item">
						<cell custom-class="month-item" data-audio="{{ item.audio }}" bindtap="wordPlay">
							<text slot="hd" class="strong">{{ item.word }}</text>
							<text slot="bd" class="phonetic">　/{{ item.phonetic}}/ {{ item.mean}}</text>
							<view slot="ft" style="display: flex; align-items: center;">
								<van-icon  name="volume-o" color="#87BE5D" size="18"  />
							</view>
						</cell>

					</view>
				</view>
			</block>

			<view class="close-wrap"  bindtap="popOnClose">
				<van-icon name="cross" />
			</view>
		</view>
	</van-popup>
</view>